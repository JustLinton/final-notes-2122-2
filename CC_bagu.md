#### 地址译码器的输入是什么？输出是什么？可寻址范围多少？

输入是地址，输出是地址驱动信号（只有一根地址驱动线被选中）。

#### 直接存取存储器和相联存储器？

- 直接存取存储器根据地址就能定位到相应位置。
- 相联存储器的意思是其存放的位置和其内容有联系。根据其存储的内容即可定位到物理地址。（例如TLB）

#### 常见的存储结构是用什么类型的存储器？

- BIOS采用闪存ROM（Flash ROM）
- Cache是SRAM
- 主存是DRAM

#### 局部性产生的原因

- 程序代码、数据是**连续**存放的，且遵循一定的**顺序**（栈帧显然是一块连续空间）

#### 时间、空间局部性例子

程序1：

```c
int sumarrayrows(int a[M][N])
 {
    int i, j, sum=0;
        for  (i=0; i<M, i++)
	for (j=0; j<N, j++)  sum+=a[i][j];
        return sum;
 }
```

程序2：

```c
 int sumarraycols(int a[M][N])
 {
     int i, j, sum=0;
          for  (j=0; j<N, j++)
	  for (i=0; i<M, i++)  sum+=a[i][j];
           return sum;
 }
```

**程序1比程序2快21.5倍。**因为二维数组访问的方法，前者的空间局部性好。

#### 组相联映射向其他两种映射的转换

- 如果组群大小=1，那么所有块都可以看作是自己组群里的第一个块，且cache也只能分出一个组来，此时所有快都可以映射到cache的任意位置，所以是全相联映射。
- 如果cache的组大小=1，那么这是一个直接映射。因为内存组群中的所有块都只能映射到固定位置。

#### Cache的miss损失（miss penalty）

- 即访问主存块所需要的时间。

#### 关联度

- 即一个内存块可能映射到的Cache块的数量。
  - 直接映射：1
  - 全相联映射：Cache块数
  - N路组向量映射：**路数**
- 关联度越高，访存发生Cache miss的概率越低。

#### 颠簸

- 如果使用LIFO或LRU替换算法，如果cache最近的块大小总是小于最近会访问的块的总数，就会出现颠簸。
- 即OS里面页面置换发生的抖动（因为虚存也是采用了Cache的思想，可以把内存看成是一个大Cache。）

#### Cache数据一致性问题

- 若多个CPU核心都带着各自的L1、L2 Cache对某段程序进行并行操作，那么其中一个核心修改了自己Cache里面对于某段内存空间的映射，而如果这几个线程都共享这一个内存空间，就会发生数据不一致的问题。
  - 因为在这个瞬间，只有修改Cache的那个核心带的Cache中是最新的数据。其他核心和原有内存单元中的数据都过时了。
- 若多个IO设备同时访存，CPU却不加以限制，就会导致内存被IO设备修改了，但是Cache 没跟上。或者CPU修改了Cache但是没有及时写回，IO设备就读出过时数据。

#### Cache写策略

- 如果发生写不命中，那好说；但是如果命中了Cache，那就写入Cache，从而需要对数据一致性进行保证。
- 因为这样就比较复杂，所以指令Cache比数据Cache更好设计。因为指令往往不需要写回去。
- 如果`写命中`
  - 写直达法
    - 每次写Cache，也同时写入内存（效率大大降低，导致就算写命中也没什么效率提升）
    - 改进：增加写缓冲。然后并不需要写入内存，而是写入缓冲。
  - 写回法（添加脏位）
    - 添加一个脏位。如果需要被换出，看看脏位如果为1，就写入；否则丢弃。
- 如果`写不命中`
  - 写分配法
    - 写，顺便把所在内存块换入Cache。（试图进一步利用局部性）
  - 非写分配法
    - 只是直接往内存写，不考虑换入的问题。

#### Cache读策略

- 如果没命中，就从内存取。否则直接读。
- 可见，读策略相对于写策略及其简单。

#### 分页管理和Cache的区别与联系

- 分页实际上是一个**使用全相联映射**的大Cache。
  - 因为全相联映射的命中率是三种映射中最高的。分页管理最重要的就是命中率，因为如果发生缺页中断，**调入一页需要数百万个时钟周期**，这相比其他操作都太慢了。
- 采用写回法的写策略，同样是为了减少磁盘IO。
- 缺页中断可以通过软件解决，因为它需要数百万个时钟周期，**非常慢，所以硬件无法实现。**

#### 空洞页面

- 如果**虚拟地址空间中（即页表中）**有的项目没有任何信息（即没有确定页面编号和页面）

